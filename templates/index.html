{% extends "base.html" %}

{% block title %}Dashboard - FlowState{% endblock %}

{% block content %}

<!-- Dashboard Header -->
<div class="mb-8">
    <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-flow-purple to-flow-cyan bg-clip-text text-transparent">
        Your Catalog
    </h1>
    <p class="text-gray-400 text-lg">Manage your lyrical creations</p>
</div>

<!-- Stats Cards -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    
    <!-- Total Songs -->
    <div class="glass-card rounded-2xl p-6 border border-flow-purple/20">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm uppercase tracking-wide mb-1">Total Songs</p>
                <p class="text-4xl font-bold text-white">{{ songs|length }}</p>
            </div>
            <i data-lucide="music" class="w-12 h-12 text-flow-purple"></i>
        </div>
    </div>
    
    <!-- AI Songs Count -->
    <div class="glass-card rounded-2xl p-6 border border-flow-cyan/20">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm uppercase tracking-wide mb-1">AI-Assisted</p>
                <p class="text-4xl font-bold text-white">
                    {{ songs|selectattr('is_ai_generated', 'equalto', true)|list|length }}
                </p>
            </div>
            <i data-lucide="bot" class="w-12 h-12 text-flow-cyan"></i>
        </div>
    </div>
    
    <!-- Human Songs Count -->
    <div class="glass-card rounded-2xl p-6 border border-green-500/20">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-400 text-sm uppercase tracking-wide mb-1">Human-Written</p>
                <p class="text-4xl font-bold text-white">
                    {{ songs|selectattr('is_ai_generated', 'equalto', false)|list|length }}
                </p>
            </div>
            <i data-lucide="user" class="w-12 h-12 text-green-400"></i>
        </div>
    </div>
</div>

<!-- Songs Section Header -->
<div class="flex items-center justify-between mb-6">
    <h2 class="text-2xl font-bold text-white">Your Songs</h2>
    <a href="/song/new" class="text-flow-purple hover:text-flow-cyan transition-colors duration-300 flex items-center space-x-2">
        <i data-lucide="plus-circle" class="w-5 h-5"></i>
        <span>Add New</span>
    </a>
</div>

<!-- Empty State (No songs yet) -->
{% if songs|length == 0 %}
    <div class="glass-card rounded-2xl p-12 text-center">
        <i data-lucide="music-2" class="w-24 h-24 text-gray-600 mx-auto mb-4"></i>
        <h3 class="text-2xl font-bold text-gray-300 mb-2">No songs yet</h3>
        <p class="text-gray-500 mb-6">Start building your catalog by adding your first song</p>
        <a href="/song/new" class="btn-glow bg-gradient-to-r from-flow-purple to-flow-blue text-white px-8 py-3 rounded-lg font-semibold inline-flex items-center space-x-2">
            <i data-lucide="plus" class="w-5 h-5"></i>
            <span>Create Your First Song</span>
        </a>
    </div>
{% else %}
<!-- Song Cards Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for song in songs %}
        
        <!-- Individual Song Card -->
        <div class="glass-card rounded-2xl p-6 hover:scale-105 hover:border-flow-purple transition-all duration-300 border border-gray-700 group">
            
            <!-- Song Header -->
            <div class="flex items-start justify-between mb-4">
                <div class="flex-1">
                    <h3 class="text-xl font-bold text-white mb-2 group-hover:text-flow-purple transition-colors">
                        {{ song.title }}
                    </h3>
                    
                    <!-- Status Badge -->
                    <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold
                        {% if song.status == 'draft' %}bg-yellow-500/20 text-yellow-400 border border-yellow-500/30
                        {% elif song.status == 'recording' %}bg-blue-500/20 text-blue-400 border border-blue-500/30
                        {% elif song.status == 'complete' %}bg-green-500/20 text-green-400 border border-green-500/30
                        {% endif %}">
                        {% if song.status == 'draft' %}üìù Draft
                        {% elif song.status == 'recording' %}üéôÔ∏è Recording
                        {% elif song.status == 'complete' %}‚úÖ Complete
                        {% endif %}
                    </span>
                </div>
                
                <!-- AI Badge (if AI-generated) -->
                {% if song.is_ai_generated %}
                <span class="ml-2 inline-flex items-center px-2 py-1 rounded-lg bg-flow-cyan/20 text-flow-cyan border border-flow-cyan/30 text-xs font-semibold">
                    <i data-lucide="bot" class="w-3 h-3 mr-1"></i>
                    AI
                </span>
                {% endif %}
            </div>
            
            <!-- Song Info -->
            <div class="space-y-3 mb-6">
                <div class="flex items-center text-gray-400 text-sm">
                    <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                    <span>{{ song.lyrics|length }} verse(s)</span>
                </div>
                <div class="flex items-center text-gray-400 text-sm">
                    <i data-lucide="calendar" class="w-4 h-4 mr-2"></i>
                    <span>{{ song.date_created.strftime('%b %d, %Y') }}</span>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex gap-3">
                <a href="/song/{{ song.id }}" 
                   aria-label="View details for {{ song.title }}"
                   class="flex-1 bg-gradient-to-r from-flow-purple to-flow-blue text-white text-center py-2.5 rounded-lg font-semibold hover:shadow-lg hover:shadow-flow-purple/50 transition-all duration-300">
                    View Song
                </a>
                
                <!-- Delete Button (Form) -->
                <form method="POST" action="{{ url_for('delete_song', song_id=song.id) }}" 
                      onsubmit="return confirm('Delete {{ song.title }} and all its lyrics? This cannot be undone.');">
                    <button type="submit"
                            aria-label="Delete {{ song.title }}"
                            class="bg-red-500/20 text-red-400 border border-red-500/30 px-4 py-2.5 rounded-lg hover:bg-red-500/30 transition-all duration-300">
                        <i data-lucide="trash-2" class="w-5 h-5"></i>
                    </button>
                </form>
            </div>
            
        </div>
        {% endfor %}
    </div>
{% endif %}

{% endblock %}